<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ROYAL CASINO: MOBILE</title>
    <style>
        /* --- RESET & BASIC --- */
        * { box-sizing: border-box; }
        :root {
            --bg-dark: #0f1115; --bg-card: #1a1d24; --accent: #ffd700;
            --neon-green: #00ff88; --neon-red: #ff4444; --text-main: #ffffff;
            --text-muted: #8b9bb4;
        }

        body {
            margin: 0; background-color: var(--bg-dark); color: var(--text-main);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            overflow-x: hidden; -webkit-tap-highlight-color: transparent;
            padding-bottom: 20px;
        }

        /* --- HEADER --- */
        header {
            background: rgba(26, 29, 36, 0.95); padding: 10px 15px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 100;
            backdrop-filter: blur(10px); flex-wrap: wrap; gap: 10px;
        }
        .logo { font-size: 20px; font-weight: 800; color: var(--accent); text-transform: uppercase; }
        .logo span { color: #fff; }

        .user-panel { display: flex; gap: 10px; align-items: center; }
        .balance-box {
            background: #000; padding: 6px 12px; border-radius: 6px; border: 1px solid #333;
            display: flex; gap: 5px; font-weight: bold; font-size: 14px;
        }
        .balance-val { color: var(--neon-green); }

        .btn-deposit {
            background: var(--neon-green); color: #000; border: none; padding: 6px 12px;
            border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 14px;
        }

        /* --- LAYOUT --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 20px 15px; }
        .section-title {
            display: flex; align-items: center; gap: 10px; font-size: 18px;
            margin-bottom: 15px; color: var(--text-muted); text-transform: uppercase;
            letter-spacing: 1px; border-bottom: 1px solid #333; padding-bottom: 10px;
        }

        /* --- GRID AUTOMAT≈Æ --- */
        .games-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); /* Men≈°√≠ karty pro mobil */
            gap: 15px; 
        }

        .game-card {
            background: var(--bg-card); border-radius: 12px; overflow: hidden; cursor: pointer;
            position: relative; border: 1px solid #333; height: 200px;
            display: flex; flex-direction: column; transition: transform 0.2s;
        }
        .game-card:active { transform: scale(0.98); }

        .card-img {
            height: 140px; background: linear-gradient(45deg, #2c3e50, #000);
            display: flex; justify-content: center; align-items: center; font-size: 50px; position: relative;
        }
        .card-info { padding: 10px; background: #252a33; flex-grow: 1; display: flex; flex-direction: column; justify-content: center; }
        .card-title { font-weight: bold; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; }
        .card-provider { font-size: 11px; color: var(--text-muted); }
        .play-btn-small { display: none; } /* Na mobilu zbyteƒçn√© */

        /* --- CRYPTO --- */
        .crypto-dashboard {
            background: var(--bg-card); border: 1px solid #333; border-radius: 12px; padding: 15px;
            display: flex; flex-direction: column; gap: 15px;
        }
        .crypto-chart { background: #111; border-radius: 8px; border: 1px solid #444; width: 100%; height: 200px; }
        .crypto-controls { display: flex; gap: 10px; margin-top: 10px; }
        .c-btn { flex: 1; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: #fff; }
        .btn-buy { background: #008000; } .btn-sell { background: #800000; }

        /* --- GAME OVERLAY (COMMON) --- */
        .game-interface {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-dark); z-index: 200; flex-direction: column;
            overflow-y: auto; /* Povolit scrollov√°n√≠ na mal√Ωch mobilech */
        }
        .game-nav { 
            padding: 10px 15px; background: #151515; display: flex; align-items: center; gap: 15px; 
            border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 10;
        }
        .back-btn { background: #333; color: #fff; border: 1px solid #555; padding: 8px 15px; border-radius: 4px; font-weight: bold; }
        
        /* Spoleƒçn√© prvky ovl√°d√°n√≠ */
        .bet-btn { background: #333; color: #fff; border: 1px solid #555; padding: 10px 15px; border-radius: 5px; font-weight: bold; min-width: 40px; }
        .spin-btn { 
            background: linear-gradient(180deg, var(--accent) 0%, #d4b100 100%); 
            border: none; padding: 15px; width: 100%; font-size: 20px; font-weight: bold; 
            color: #222; border-radius: 8px; margin-top: 10px; box-shadow: 0 4px 0 #998000;
        }
        .spin-btn:active { transform: translateY(4px); box-shadow: none; }
        
        /* --- 1. AUTOMATY --- */
        .slot-machine-wrapper { flex-grow: 1; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .machine-body { 
            background: #222; padding: 20px; border-radius: 20px; border: 4px solid #444; 
            text-align: center; width: 100%; max-width: 500px;
        }
        .reels { 
            display: flex; gap: 5px; background: #000; padding: 10px; border-radius: 10px; 
            margin: 15px 0; height: 120px; overflow: hidden; 
        }
        .reel { 
            flex: 1; background: #fff; border-radius: 5px; display: flex; justify-content: center; 
            align-items: center; font-size: 40px; 
        }
        .reel.spinning { 
            color: transparent; background-image: linear-gradient(180deg, #ccc 25%, #fff 50%, #ccc 75%); 
            background-size: 100% 20%; animation: blurSpin 0.1s infinite linear; 
        }
        @keyframes blurSpin { 0% { background-position: 0 0; } 100% { background-position: 0 100px; } }
        .controls-row { display: flex; justify-content: center; gap: 10px; margin-bottom: 10px; }

        /* --- 2. RULETA --- */
        .roulette-wrapper { padding: 20px; display: flex; flex-direction: column; align-items: center; width: 100%; }
        .roulette-board { 
            display: grid; grid-template-columns: repeat(6, 1fr); /* M√©nƒõ sloupc≈Ø pro mobil */
            gap: 4px; background: #004d1a; padding: 10px; border-radius: 10px; 
            border: 3px solid #d4b100; width: 100%; max-width: 600px;
        }
        .r-num { 
            padding: 10px 5px; text-align: center; font-weight: bold; border-radius: 3px; color: #fff; 
            font-size: 14px; border: 2px solid transparent; 
        }
        .r-green { grid-column: span 6; background: #008000; }
        .r-red { background: #b30000; } .r-black { background: #111; }
        .r-selected { border-color: #ffd700; z-index: 5; transform: scale(1.05); }
        .r-highlight { background: #fff !important; color: #000 !important; }
        
        .roulette-controls { 
            margin-top: 20px; background: #111; padding: 15px; border-radius: 10px; 
            width: 100%; max-width: 600px; display: flex; flex-direction: column; gap: 15px;
        }

        /* --- 3. BLACKJACK --- */
        .bj-wrapper { padding: 10px; width: 100%; display: flex; flex-direction: column; align-items: center; }
        .bj-table { 
            width: 100%; max-width: 500px; min-height: 400px; background: #267326; 
            border: 10px solid #3d1f00; border-radius: 50px; position: relative; 
            display: flex; flex-direction: column; justify-content: space-between; padding: 20px;
        }
        .hand-area { display: flex; flex-direction: column; align-items: center; min-height: 120px; }
        .cards-container { display: flex; justify-content: center; margin-top: 5px; height: 100px; }
        .playing-card { 
            width: 60px; height: 85px; background: #fff; border-radius: 6px; 
            display: flex; flex-direction: column; justify-content: space-between; padding: 3px;
            font-weight: bold; font-size: 16px; color: #000; box-shadow: 1px 1px 5px rgba(0,0,0,0.5);
            margin-left: -20px; /* P≈ôekryv */
        }
        .playing-card:first-child { margin-left: 0; }
        .playing-card.red { color: #d00; }
        .playing-card.hidden { background: #b00; border: 2px solid #fff; }
        .playing-card.hidden span { display: none; }
        .score-bubble { background: #000; color: #fff; padding: 2px 10px; border-radius: 15px; z-index: 10; border: 1px solid #ffd700; font-size: 12px; }
        #bjResult { text-align: center; font-size: 24px; text-shadow: 0 0 5px #000; margin: 10px 0; min-height: 30px;}
        .bj-action-row { display: flex; gap: 10px; margin-top: 10px; }
        .bj-btn { flex: 1; padding: 15px; border-radius: 8px; border: none; font-weight: bold; font-size: 16px; }
        .btn-hit { background: #2ecc71; } .btn-stand { background: #e74c3c; color: #fff; } .btn-deal { background: #f1c40f; width: 100%; }

        /* --- 4. DOSTIHY --- */
        .race-wrapper { padding: 10px; width: 100%; display: flex; flex-direction: column; align-items: center; }
        .race-scroll-container {
            width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; 
            border: 2px solid #444; border-radius: 8px; margin-bottom: 10px;
        }
        .race-track { 
            width: 800px; /* Fixn√≠ ≈°√≠≈ôka uvnit≈ô scrollu */
            background: #5a4b3c; padding: 10px; position: relative;
            background-image: repeating-linear-gradient(90deg, transparent 0, transparent 49px, rgba(255,255,255,0.1) 50px);
        }
        .finish-line { position: absolute; right: 20px; top: 0; bottom: 0; width: 4px; background: repeating-linear-gradient(0deg, #fff, #fff 5px, #000 5px, #000 10px); z-index: 0; }
        .horse-lane { height: 50px; border-bottom: 1px dashed rgba(255,255,255,0.3); position: relative; display: flex; align-items: center; }
        .horse-model { font-size: 30px; position: absolute; left: 0; transition: left 0.1s linear; z-index: 1; display: flex; align-items: center; gap: 5px; }
        .horse-tag { font-size: 10px; background: rgba(0,0,0,0.8); padding: 2px; color: #fff; border-radius: 3px; }
        
        .race-controls { 
            background: #151515; padding: 15px; border-radius: 10px; width: 100%; max-width: 600px;
            display: flex; flex-direction: column; gap: 15px;
        }
        .horse-selector { display: flex; justify-content: space-between; gap: 5px; overflow-x: auto; padding-bottom: 5px; }
        .horse-btn { 
            background: #333; border: 1px solid #555; color: #fff; padding: 8px; flex: 1; min-width: 60px;
            cursor: pointer; border-radius: 5px; display: flex; flex-direction: column; align-items: center; font-size: 11px; 
        }
        .horse-btn.selected { background: var(--accent); color: #000; border-color: var(--accent); }

        /* --- MEDIA QUERIES (TABLET & DESKTOP) --- */
        @media (min-width: 768px) {
            .games-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); }
            .game-card { height: 280px; }
            .card-img { height: 200px; font-size: 60px; }
            .play-btn-small { display: block; background: var(--accent); color: #000; padding: 10px 25px; border-radius: 20px; font-weight: bold; position: absolute; }
            .roulette-board { grid-template-columns: repeat(12, 1fr); }
            .r-green { grid-column: span 12; }
            .btn-red-big, .btn-black-big { grid-column: span 6; }
            .playing-card { width: 80px; height: 110px; font-size: 20px; margin-left: -40px; }
        }

    </style>
</head>
<body>

    <header>
        <div class="logo">ROYAL <span>CASINO</span></div>
        <div class="user-panel">
            <div class="balance-box">
                <span>CZK</span>
                <span class="balance-val" id="globalBalance">5000.00</span>
            </div>
            <button class="btn-deposit" onclick="addMoney()">+ VKLAD</button>
        </div>
    </header>

    <div class="container" id="lobby">
        <div class="section-title">üî• Hry</div>
        <div class="games-grid" id="gamesGrid">
            </div>

        <br>
        <div class="section-title">üìä Krypto (JNC)</div>
        <div class="crypto-dashboard">
            <div style="display:flex; justify-content:space-between; align-items:flex-end;">
                <div>
                    <h2 style="margin:0; color:var(--accent)">Jancoin</h2>
                    <div style="font-size:14px; color:#888;">Owned: <span id="cryptoOwned">0</span></div>
                </div>
                <div style="text-align:right;">
                    <div id="cryptoPrice" style="font-size:20px; font-weight:bold;">100.00</div>
                    <div style="font-size:12px; color:#666">CZK</div>
                </div>
            </div>
            <canvas id="cryptoChart" class="crypto-chart"></canvas>
            <div class="crypto-controls">
                <button class="c-btn btn-buy" onclick="tradeCrypto('buy')">KOUPIT</button>
                <button class="c-btn btn-sell" onclick="tradeCrypto('sell')">PRODAT</button>
            </div>
        </div>
    </div>

    <div id="slot-interface" class="game-interface">
        <div class="game-nav">
            <button class="back-btn" onclick="closeGame()">‚ùÆ Zpƒõt</button>
            <span id="activeGameTitle" style="font-weight:bold;">Automat</span>
        </div>
        <div class="slot-machine-wrapper">
            <div class="machine-body" id="machineBody">
                <h3 id="machineHeaderTitle" style="margin:0 0 10px 0; text-transform:uppercase;">GAME</h3>
                <div class="reels">
                    <div class="reel" id="reel1">üçí</div>
                    <div class="reel" id="reel2">üçí</div>
                    <div class="reel" id="reel3">üçí</div>
                </div>
                
                <div style="display:flex; justify-content:space-between; font-weight:bold; font-size:14px; margin-bottom:10px;">
                    <span>S√°zka: <span id="slotBet">10</span></span>
                    <span>V√Ωhra: <span id="slotWin" style="color:var(--neon-green)">0</span></span>
                </div>

                <div class="controls-row">
                    <button class="bet-btn" onclick="adjustSlotBet(-10)">-</button>
                    <button class="bet-btn" onclick="adjustSlotBet(10)">+</button>
                    <button class="bet-btn" onclick="setSlotMaxBet()">MAX</button>
                </div>
                <button class="spin-btn" id="spinBtn" onclick="spinSlot()">ROZTOƒåIT</button>
                <p id="slotMsg" style="min-height:20px; font-weight:bold; margin-top:10px; font-size:14px;">Hodnƒõ ≈°tƒõst√≠!</p>
            </div>
        </div>
    </div>

    <div id="roulette-interface" class="game-interface">
        <div class="game-nav">
            <button class="back-btn" onclick="closeGame()">‚ùÆ Zpƒõt</button>
            <span style="font-weight:bold;">Ruleta</span>
        </div>
        <div class="roulette-wrapper">
            <div class="roulette-board" id="rouletteBoard"></div>
            
            <div class="roulette-controls">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div style="font-size:14px;">
                        <div>Tip: <span id="rSelectedInfo" style="color:var(--accent)">Nic</span></div>
                        <div>S√°zka: <b id="rBetAmount">100</b></div>
                    </div>
                    <div>
                        <button class="bet-btn" onclick="adjustRouletteBet(-100)">-</button>
                        <button class="bet-btn" onclick="adjustRouletteBet(100)">+</button>
                    </div>
                </div>
                <button class="spin-btn" style="background:linear-gradient(180deg, #ff4444, #900)" onclick="spinRoulette()">TOƒåIT</button>
                <div id="rMsg" style="text-align:center; font-weight:bold; min-height:20px;"></div>
            </div>
        </div>
    </div>

    <div id="blackjack-interface" class="game-interface">
        <div class="game-nav">
            <button class="back-btn" onclick="closeGame()">‚ùÆ Zpƒõt</button>
            <span style="font-weight:bold;">Blackjack</span>
        </div>
        <div class="bj-wrapper">
            <div class="bj-table">
                <div class="hand-area">
                    <span style="color:#ccc; font-size:12px;">DEALER</span>
                    <div class="score-bubble" id="dealerScore">0</div>
                    <div class="cards-container" id="dealerCards"></div>
                </div>
                
                <div id="bjResult"></div>

                <div class="hand-area">
                    <div class="cards-container" id="playerCards"></div>
                    <div class="score-bubble" id="playerScore">0</div>
                    <span style="color:#ccc; font-size:12px;">TY</span>
                </div>
            </div>

            <div style="width:100%; max-width:500px; margin-top:15px; background:#111; padding:15px; border-radius:10px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                    <span>S√°zka: <b id="bjBetAmount">100</b></span>
                    <div>
                        <button class="bet-btn" onclick="adjustBjBet(-100)">-</button>
                        <button class="bet-btn" onclick="adjustBjBet(100)">+</button>
                    </div>
                </div>

                <div id="bjDealDiv">
                    <button class="bj-btn btn-deal" onclick="bjDeal()">ROZDAT</button>
                </div>
                <div id="bjActions" class="bj-action-row" style="display:none;">
                    <button class="bj-btn btn-hit" onclick="bjHit()">HIT</button>
                    <button class="bj-btn btn-stand" onclick="bjStand()">STAND</button>
                </div>
            </div>
        </div>
    </div>

    <div id="race-interface" class="game-interface">
        <div class="game-nav">
            <button class="back-btn" onclick="closeGame()">‚ùÆ Zpƒõt</button>
            <span style="font-weight:bold;">Dostihy</span>
        </div>
        <div class="race-wrapper">
            <h3 id="raceStatus" style="color:var(--accent); margin:0 0 10px 0; text-align:center;">Vyber konƒõ</h3>
            
            <div class="race-scroll-container">
                <div class="race-track" id="raceTrack"></div>
            </div>

            <div class="race-controls">
                <div class="horse-selector" id="horseSelector"></div>
                
                <div style="display:flex; justify-content:space-between; align-items:center; border-top:1px solid #333; padding-top:10px;">
                    <div>S√°zka: <b id="raceBetAmount">100</b></div>
                    <div>
                        <button class="bet-btn" onclick="adjustRaceBet(-100)">-</button>
                        <button class="bet-btn" onclick="adjustRaceBet(100)">+</button>
                    </div>
                </div>
                <button class="spin-btn" id="startRaceBtn" style="background:linear-gradient(180deg, #e67e22, #d35400)" onclick="startRace()">START</button>
            </div>
        </div>
    </div>

    <script>
        /* --- CONFIG --- */
        const GAMES = [
            { id: 1, name: "Inzul√≠n Mat", winChance: 40, color: "#ff5555", symbols: ["üíâ", "ü©∏", "üç¨", "üöë", "üç∞"], icon: "üíâ" },
            { id: 2, name: "Gargamel", winChance: 25, color: "#5555ff", symbols: ["üêà", "üßô‚Äç‚ôÇÔ∏è", "üçÑ", "üß™", "ü•ò"], icon: "üßô‚Äç‚ôÇÔ∏è" },
            { id: 3, name: "Niƒçeho Gamba", winChance: 10, color: "#888888", symbols: ["üö¨", "üí®", "ü•É", "üï∂Ô∏è", "‚ö´"], icon: "üï∂Ô∏è" },
            { id: 4, name: "Vyj√≠d√°ƒçek", winChance: 50, color: "#e67e22", symbols: ["üöú", "ü•ì", "üå≠", "üç∫", "üê∑"], icon: "üå≠" },
            { id: 5, name: "Zarybovo", winChance: 30, color: "#3498db", symbols: ["üêü", "üê†", "üé£", "ü¶à", "ü¶û"], icon: "üêü" },
            { id: 6, name: "R√°kosn√≠k", winChance: 35, color: "#2ecc71", symbols: ["üê∏", "üéã", "üåú", "‚ú®", "üö§"], icon: "üéã" },
            { id: 7, name: "SPSEMOH", winChance: 90, color: "#9b59b6", symbols: ["üíª", "üíæ", "üîå", "üìö", "üéì"], icon: "üíª" },
            { id: 8, name: "Jancoin", winChance: 33, color: "#f1c40f", symbols: ["ü™ô", "üöÄ", "üìâ", "üêÇ", "üí∞"], icon: "üöÄ" }
        ];
        const HORSES = [
            { id: 1, name: "Blesk", color: "#ff4444", icon: "üêé" },
            { id: 2, name: "Vichr", color: "#4444ff", icon: "ü¶Ñ" },
            { id: 3, name: "Loudal", color: "#00ff88", icon: "ü¶ì" },
            { id: 4, name: "Spirit", color: "#ffd700", icon: "üê¥" },
            { id: 5, name: "Emil", color: "#ffffff", icon: "üèá" }
        ];

        /* --- STATE --- */
        let balance = 5000;
        let currentSlotBet = 10;
        let activeSlotGame = null;
        
        let cryptoPrice = 100; let cryptoOwned = 0; let cryptoHistory = [100];
        const ctx = document.getElementById('cryptoChart').getContext('2d');

        let rouletteBet = 100; let rouletteSelection = null;
        const redNumbers = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];

        let bjBet = 100; let bjDeck = []; let bjPlayerHand = []; let bjDealerHand = []; let bjGameActive = false;
        let raceBet = 100; let selectedHorse = null; let raceActive = false; let horsePositions = [0,0,0,0,0];

        /* --- INIT --- */
        const grid = document.getElementById('gamesGrid');
        
        GAMES.forEach(game => {
            const card = document.createElement('div'); card.className = 'game-card'; card.onclick = () => openSlotGame(game.id);
            card.innerHTML = `<div class="card-img" style="color: ${game.color};">${game.icon}</div><div class="card-info"><span class="card-title">${game.name}</span><span class="card-provider">Automat</span></div>`;
            grid.appendChild(card);
        });
        
        // Add extra games
        const addCard = (icon, title, color, action) => {
            const c = document.createElement('div'); c.className = 'game-card'; c.onclick = action; c.style.borderColor = color;
            c.innerHTML = `<div class="card-img" style="background: radial-gradient(${color}, #000); color: #fff;">${icon}</div><div class="card-info"><span class="card-title">${title}</span><span class="card-provider">Hra</span></div>`;
            grid.appendChild(c);
        };
        addCard('üé°', 'Ruleta', '#ff4444', openRouletteGame);
        addCard('‚ô†Ô∏è', 'Blackjack', '#2ecc71', openBlackjackGame);
        addCard('üèá', 'Dostihy', '#e67e22', openHorseRace);

        // Init Roulette
        const rBoard = document.getElementById('rouletteBoard');
        const mkDiv = (cls, txt, onclick) => { const d=document.createElement('div'); d.className=cls; d.textContent=txt; d.onclick=onclick; return d; };
        rBoard.appendChild(mkDiv('r-num r-green','0',()=>selRoulette(0, event.target)));
        for(let i=1; i<=36; i++) rBoard.appendChild(mkDiv(`r-num ${redNumbers.includes(i)?'r-red':'r-black'}`, i, ()=>selRoulette(i, event.target)));
        // Barvy v gridu pro mobil
        const rRed = mkDiv('r-num r-red', 'üî¥', ()=>selRoulette('red', event.target)); rRed.style.gridColumn = "span 3"; rBoard.appendChild(rRed);
        const rBlack = mkDiv('r-num r-black', '‚ö´', ()=>selRoulette('black', event.target)); rBlack.style.gridColumn = "span 3"; rBoard.appendChild(rBlack);

        /* --- FUNCTIONS --- */
        function updateUI() { 
            document.getElementById('globalBalance').textContent = balance.toFixed(0); 
            document.getElementById('cryptoOwned').textContent = cryptoOwned.toFixed(2); 
            document.getElementById('cryptoPrice').textContent = cryptoPrice.toFixed(2); 
        }
        function addMoney() { balance += 1000; updateUI(); }
        function closeGame() { document.querySelectorAll('.game-interface').forEach(e => e.style.display = 'none'); document.getElementById('lobby').style.display = 'block'; }

        // --- SLOTS ---
        function openSlotGame(id) {
            activeSlotGame = GAMES.find(g => g.id === id);
            document.getElementById('machineHeaderTitle').textContent = activeSlotGame.name;
            document.getElementById('machineHeaderTitle').style.color = activeSlotGame.color;
            document.getElementById('machineBody').style.borderColor = activeSlotGame.color;
            ['reel1','reel2','reel3'].forEach(r => document.getElementById(r).textContent = activeSlotGame.icon);
            document.getElementById('lobby').style.display = 'none'; document.getElementById('slot-interface').style.display = 'flex';
        }
        function adjustSlotBet(v) { currentSlotBet = Math.max(10, Math.min(balance, currentSlotBet + v)); document.getElementById('slotBet').textContent = currentSlotBet; }
        function setSlotMaxBet() { currentSlotBet = Math.max(10, balance); document.getElementById('slotBet').textContent = currentSlotBet; }
        function spinSlot() {
            if(balance < currentSlotBet) return;
            balance -= currentSlotBet; updateUI();
            document.getElementById('spinBtn').disabled = true; document.getElementById('slotMsg').textContent = "...";
            ['reel1','reel2','reel3'].forEach(id => { document.getElementById(id).classList.add('spinning'); document.getElementById(id).textContent = ""; });
            const win = Math.random()*100 < activeSlotGame.winChance;
            const sym = activeSlotGame.symbols;
            const res = win ? Array(3).fill(sym[Math.floor(Math.random()*sym.length)]) : [sym[0], sym[1], sym[2]].sort(()=>Math.random()-0.5);
            setTimeout(() => stopSlot(1, res[0]), 500); setTimeout(() => stopSlot(2, res[1]), 1000); setTimeout(() => stopSlot(3, res[2], win), 1500);
        }
        function stopSlot(n, s, win) {
            const r = document.getElementById(`reel${n}`); r.classList.remove('spinning'); r.textContent = s;
            if(win !== undefined) {
                document.getElementById('spinBtn').disabled = false;
                if(win) {
                    const amt = currentSlotBet * (5 + activeSlotGame.symbols.indexOf(s)*2);
                    balance += amt; updateUI(); document.getElementById('slotWin').textContent = amt; document.getElementById('slotMsg').textContent = `V√ùHRA ${amt}!`; document.getElementById('slotMsg').style.color = "#00ff88";
                } else {
                    document.getElementById('slotWin').textContent = "0"; document.getElementById('slotMsg').textContent = "Nic."; document.getElementById('slotMsg').style.color = "#fff";
                }
            }
        }

        // --- ROULETTE ---
        function openRouletteGame() { document.getElementById('lobby').style.display='none'; document.getElementById('roulette-interface').style.display='flex'; }
        function adjustRouletteBet(v) { rouletteBet = Math.max(10, Math.min(balance, rouletteBet + v)); document.getElementById('rBetAmount').textContent = rouletteBet; }
        function selRoulette(s, el) { rouletteSelection=s; document.querySelectorAll('.r-num').forEach(e=>e.classList.remove('r-selected')); el.classList.add('r-selected'); document.getElementById('rSelectedInfo').textContent = s; }
        function spinRoulette() {
            if(!rouletteSelection || balance<rouletteBet) return;
            balance -= rouletteBet; updateUI(); document.getElementById('rMsg').textContent = "...";
            setTimeout(() => {
                const res = Math.floor(Math.random()*37);
                let w = 0;
                if(rouletteSelection===res) w=rouletteBet*36;
                else if(rouletteSelection==='red' && redNumbers.includes(res)) w=rouletteBet*2;
                else if(rouletteSelection==='black' && !redNumbers.includes(res) && res!==0) w=rouletteBet*2;
                
                document.querySelectorAll('.r-num').forEach(e=>e.classList.remove('r-highlight'));
                // Simple highlight logic for mobile (by index is tricky with custom grid, simplistic approach)
                document.getElementById('rMsg').textContent = `Padla ${res}. ${w>0?'V√Ωhra '+w:'Prohra.'}`;
                if(w>0) { balance += w; updateUI(); }
            }, 1000);
        }

        // --- BLACKJACK ---
        const SUITS=['‚ô•','‚ô¶','‚ô£','‚ô†'], VALS=['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
        function openBlackjackGame() { document.getElementById('lobby').style.display='none'; document.getElementById('blackjack-interface').style.display='flex'; resetBj(); }
        function adjustBjBet(v) { if(!bjGameActive) { bjBet = Math.max(10, Math.min(balance, bjBet + v)); document.getElementById('bjBetAmount').textContent = bjBet; } }
        function resetBj() { document.getElementById('dealerCards').innerHTML=''; document.getElementById('playerCards').innerHTML=''; document.getElementById('dealerScore').textContent='0'; document.getElementById('playerScore').textContent='0'; document.getElementById('bjResult').textContent=''; document.getElementById('bjActions').style.display='none'; document.getElementById('bjDealDiv').style.display='block'; bjGameActive=false; }
        function mkDeck() { let d=[]; for(let s of SUITS) for(let v of VALS) d.push({v,s}); return d.sort(()=>Math.random()-0.5); }
        function cardVal(c) { if(['J','Q','K'].includes(c.v)) return 10; if(c.v==='A') return 11; return parseInt(c.v); }
        function handVal(h) { let s=0,a=0; h.forEach(c=>{s+=cardVal(c); if(c.v==='A') a++}); while(s>21 && a>0){s-=10; a--} return s; }
        function drawCard(c, to, hid) { const el=document.createElement('div'); el.className=`playing-card ${['‚ô•','‚ô¶'].includes(c.s)?'red':''} ${hid?'hidden':''}`; el.innerHTML=hid?'':`<span>${c.v}</span><span style="font-size:20px">${c.s}</span>`; document.getElementById(to).appendChild(el); }
        function bjDeal() {
            if(balance<bjBet) return;
            balance-=bjBet; updateUI(); bjDeck=mkDeck(); bjGameActive=true;
            bjPlayerHand=[bjDeck.pop(), bjDeck.pop()]; bjDealerHand=[bjDeck.pop(), bjDeck.pop()];
            resetBj(); document.getElementById('bjDealDiv').style.display='none'; document.getElementById('bjActions').style.display='flex';
            bjPlayerHand.forEach(c=>drawCard(c,'playerCards')); document.getElementById('playerScore').textContent=handVal(bjPlayerHand);
            drawCard(bjDealerHand[0],'dealerCards'); drawCard(bjDealerHand[1],'dealerCards',true); document.getElementById('dealerScore').textContent='?';
        }
        function bjHit() { 
            const c=bjDeck.pop(); bjPlayerHand.push(c); drawCard(c,'playerCards'); 
            const s=handVal(bjPlayerHand); document.getElementById('playerScore').textContent=s;
            if(s>21) endBj("BUST!"); 
        }
        function bjStand() {
            document.getElementById('dealerCards').innerHTML=''; bjDealerHand.forEach(c=>drawCard(c,'dealerCards'));
            let ds=handVal(bjDealerHand); document.getElementById('dealerScore').textContent=ds;
            const int=setInterval(()=>{
                if(ds<17) { const c=bjDeck.pop(); bjDealerHand.push(c); drawCard(c,'dealerCards'); ds=handVal(bjDealerHand); document.getElementById('dealerScore').textContent=ds; }
                else { clearInterval(int); checkBjWin(ds); }
            }, 600);
        }
        function checkBjWin(ds) {
            const ps=handVal(bjPlayerHand);
            if(ds>21 || ps>ds) { balance+=bjBet*2; endBj("V√ùHRA!"); }
            else if(ps===ds) { balance+=bjBet; endBj("PUSH"); }
            else endBj("PROHRA");
        }
        function endBj(msg) { document.getElementById('bjResult').textContent=msg; updateUI(); bjGameActive=false; document.getElementById('bjActions').style.display='none'; document.getElementById('bjDealDiv').style.display='block'; }

        // --- HORSES ---
        function openHorseRace() {
            document.getElementById('lobby').style.display='none'; document.getElementById('race-interface').style.display='flex';
            const track = document.getElementById('raceTrack'); track.innerHTML='<div class="finish-line"></div>';
            HORSES.forEach((h,i) => track.innerHTML += `<div class="horse-lane"><div class="horse-model" id="horse_${i}" style="color:${h.color}">${h.icon} <span class="horse-tag">${h.name}</span></div></div>`);
            const sel = document.getElementById('horseSelector'); sel.innerHTML='';
            HORSES.forEach((h,i) => {
                const b = document.createElement('div'); b.className='horse-btn'; b.innerHTML=`<span>${h.icon}</span><span>${h.name}</span>`;
                b.onclick=()=>{if(!raceActive){selectedHorse=i; document.querySelectorAll('.horse-btn').forEach(x=>x.classList.remove('selected')); b.classList.add('selected');}};
                sel.appendChild(b);
            });
            selectedHorse=null;
        }
        function adjustRaceBet(v) { if(!raceActive) { raceBet=Math.max(10,Math.min(balance,raceBet+v)); document.getElementById('raceBetAmount').textContent=raceBet; } }
        function startRace() {
            if(selectedHorse===null || balance<raceBet) return;
            balance-=raceBet; updateUI(); raceActive=true; document.getElementById('startRaceBtn').disabled=true;
            horsePositions=[0,0,0,0,0]; HORSES.forEach((_,i)=>document.getElementById(`horse_${i}`).style.left='0%');
            const int = setInterval(()=>{
                let win = -1;
                for(let i=0; i<5; i++) {
                    horsePositions[i] += Math.random()*2;
                    document.getElementById(`horse_${i}`).style.left = Math.min(90, horsePositions[i])+'%';
                    if(horsePositions[i]>=90) { win=i; break; }
                }
                if(win!==-1) {
                    clearInterval(int); raceActive=false; document.getElementById('startRaceBtn').disabled=false;
                    if(win===selectedHorse) { balance+=raceBet*5; updateUI(); alert(`V√≠tƒõz: ${HORSES[win].name}. V√Ωhra!`); }
                    else alert(`V√≠tƒõz: ${HORSES[win].name}. Prohra.`);
                }
            }, 50);
        }

        // --- CRYPTO ---
        function tradeCrypto(act) {
            if(act==='buy' && balance>=cryptoPrice) { balance-=cryptoPrice; cryptoOwned++; }
            if(act==='sell' && cryptoOwned>=1) { balance+=cryptoPrice; cryptoOwned--; }
            updateUI();
        }
        setInterval(()=>{
            cryptoPrice = Math.max(1, cryptoPrice + (Math.random()-0.5)*5);
            cryptoHistory.push(cryptoPrice); if(cryptoHistory.length>40) cryptoHistory.shift();
            // Simple chart draw (responsive-ish)
            const w=ctx.canvas.width=document.querySelector('.crypto-chart').clientWidth;
            const h=ctx.canvas.height=200;
            ctx.strokeStyle='#00ff88'; ctx.lineWidth=2; ctx.beginPath();
            const min=Math.min(...cryptoHistory), max=Math.max(...cryptoHistory), rng=max-min||1;
            cryptoHistory.forEach((p,i)=>{
                const x=(i/(cryptoHistory.length-1))*w, y=h-((p-min)/rng)*(h-20)-10;
                i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);
            });
            ctx.stroke(); updateUI();
        }, 1000);

        updateUI();
    </script>
</body>
</html>
