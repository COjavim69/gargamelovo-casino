<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SP≈†EI CASINO: ULTIMATE EDITION</title>
    <style>
        /* --- VZHLED (GLOBAL) --- */
        :root {
            --bg-dark: #0f1115;
            --bg-card: #1a1d24;
            --accent: #ffd700;
            --neon-green: #00ff88;
            --neon-red: #ff4444;
            --text-main: #ffffff;
            --text-muted: #8b9bb4;
        }

        body {
            margin: 0; background-color: var(--bg-dark); color: var(--text-main);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            overflow-x: hidden; user-select: none;
        }

        /* --- HLAVIƒåKA --- */
        header {
            background: rgba(26, 29, 36, 0.95); padding: 15px 30px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 100;
            backdrop-filter: blur(10px);
        }
        .logo { font-size: 24px; font-weight: 800; color: var(--accent); letter-spacing: 1px; text-transform: uppercase; }
        .logo span { color: #fff; }

        .user-panel { display: flex; gap: 20px; align-items: center; }
        .balance-box {
            background: #000; padding: 8px 16px; border-radius: 8px; border: 1px solid #333;
            display: flex; gap: 10px; font-weight: bold;
        }
        .balance-val { color: var(--neon-green); }

        .btn-deposit {
            background: var(--neon-green); color: #000; border: none; padding: 8px 20px;
            border-radius: 4px; font-weight: bold; cursor: pointer; transition: 0.2s;
        }
        .btn-deposit:hover { transform: scale(1.05); box-shadow: 0 0 15px rgba(0,255,136,0.4); }

        /* --- LAYOUT --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        .section-title {
            display: flex; align-items: center; gap: 10px; font-size: 20px;
            margin-bottom: 25px; color: var(--text-muted); text-transform: uppercase;
            letter-spacing: 1px; border-bottom: 1px solid #333; padding-bottom: 10px;
        }

        /* --- GRID --- */
        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }

        .game-card {
            background: var(--bg-card); border-radius: 12px; overflow: hidden; cursor: pointer;
            transition: all 0.3s; position: relative; border: 1px solid #333; height: 280px;
            display: flex; flex-direction: column;
        }
        .game-card:hover { transform: translateY(-5px); border-color: var(--accent); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        .card-img {
            height: 200px; background: linear-gradient(45deg, #2c3e50, #000);
            display: flex; justify-content: center; align-items: center; font-size: 60px; position: relative;
        }
        .card-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7);
            display: flex; justify-content: center; align-items: center; opacity: 0; transition: 0.3s;
        }
        .game-card:hover .card-overlay { opacity: 1; }
        .play-btn-small { background: var(--accent); color: #000; padding: 10px 25px; border-radius: 20px; font-weight: bold; }
        .card-info { padding: 15px; background: #252a33; flex-grow: 1; }
        .card-title { font-weight: bold; display: block; }
        .card-provider { font-size: 12px; color: var(--text-muted); }

        /* --- CRYPTO --- */
        .crypto-dashboard {
            background: var(--bg-card); border: 1px solid #333; border-radius: 12px; padding: 20px;
            display: flex; gap: 20px; align-items: center;
        }
        .crypto-info { flex: 1; }
        .crypto-chart { flex: 2; background: #111; border-radius: 8px; border: 1px solid #444; }
        .c-btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: #fff; margin-right: 5px;}
        .btn-buy { background: #008000; } .btn-sell { background: #800000; }

        /* --- HERN√ç OVERLAY (SPOLEƒåN√â) --- */
        .game-interface {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-dark); z-index: 200; flex-direction: column;
        }
        .game-nav { padding: 15px 30px; background: #151515; display: flex; align-items: center; gap: 20px; border-bottom: 1px solid #333; }
        .back-btn { background: transparent; color: #fff; border: 1px solid #555; padding: 5px 15px; border-radius: 4px; cursor: pointer; }
        
        /* Tlaƒç√≠tka */
        .spin-btn { background: linear-gradient(180deg, var(--accent) 0%, #d4b100 100%); border: none; padding: 15px; width: 100%; font-size: 24px; font-weight: bold; color: #222; border-radius: 8px; cursor: pointer; }
        .bet-btn { background: #333; color: #fff; border: 1px solid #555; padding: 5px 10px; cursor: pointer; }

        /* --- AUTOMATY SPECIFIC --- */
        .slot-machine-wrapper { flex-grow: 1; display: flex; justify-content: center; align-items: center; background-image: radial-gradient(circle at center, #2a2a2a 0%, #0f1115 70%); }
        .machine-body { background: #222; padding: 40px; border-radius: 20px; box-shadow: 0 0 50px rgba(0,0,0,0.8); border: 4px solid #444; text-align: center; width: 500px; }
        .reels { display: flex; gap: 10px; background: #000; padding: 15px; border-radius: 10px; border: 2px solid #555; margin: 20px 0; height: 150px; overflow: hidden; }
        .reel { flex: 1; background: #fff; border-radius: 5px; display: flex; justify-content: center; align-items: center; font-size: 60px; box-shadow: inset 0 0 20px rgba(0,0,0,0.5); }
        .reel.spinning { color: transparent; background-image: linear-gradient(180deg, #ccc 25%, #fff 50%, #ccc 75%); background-size: 100% 20%; animation: blurSpin 0.1s infinite linear; }
        @keyframes blurSpin { 0% { background-position: 0 0; } 100% { background-position: 0 100px; } }

        /* --- RULETA SPECIFIC --- */
        .roulette-wrapper { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #053010; }
        .roulette-board { display: grid; grid-template-columns: repeat(12, 1fr); gap: 5px; background: #004d1a; padding: 20px; border-radius: 10px; border: 5px solid #d4b100; max-width: 800px; }
        .r-num { padding: 15px; text-align: center; font-weight: bold; cursor: pointer; border-radius: 4px; color: #fff; border: 2px solid transparent; }
        .r-num:hover { transform: scale(1.1); z-index: 10; border-color: #fff; }
        .r-red { background: #b30000; } .r-black { background: #111; } .r-green { background: #008000; grid-column: span 12; }
        .r-selected { border-color: #ffd700 !important; box-shadow: 0 0 15px #ffd700; transform: scale(1.1); z-index: 10; }
        .r-highlight { background: #fff !important; color: #000 !important; box-shadow: 0 0 30px #fff; }
        .roulette-controls { margin-top: 20px; background: #111; padding: 20px; border-radius: 10px; display: flex; gap: 20px; align-items: center; border: 1px solid #444; }

        /* --- BLACKJACK SPECIFIC --- */
        .bj-wrapper { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #1a4d1a; position: relative;}
        .bj-table { width: 800px; height: 500px; background: #267326; border: 15px solid #3d1f00; border-radius: 100px; position: relative; box-shadow: inset 0 0 50px rgba(0,0,0,0.5); display: flex; flex-direction: column; justify-content: space-between; padding: 40px; }
        .hand-area { display: flex; flex-direction: column; align-items: center; min-height: 150px; }
        .cards-container { display: flex; gap: -30px; margin-top: 10px; }
        .playing-card { width: 80px; height: 110px; background: #fff; border-radius: 8px; display: flex; flex-direction: column; justify-content: space-between; padding: 5px; font-weight: bold; font-size: 20px; color: #000; box-shadow: 2px 2px 10px rgba(0,0,0,0.5); margin-right: -40px; transition: transform 0.3s; }
        .playing-card:hover { transform: translateY(-10px); z-index: 50; }
        .playing-card.red { color: #d00; }
        .playing-card.hidden { background: #b00; border: 2px solid #fff; background-image: repeating-linear-gradient(45deg, #b00 0, #b00 10px, #900 10px, #900 20px); }
        .playing-card.hidden span { display: none; }
        .score-bubble { background: #000; color: #fff; padding: 5px 15px; border-radius: 20px; margin-top: -10px; z-index: 10; border: 1px solid #ffd700; }
        .bj-controls { margin-top: 20px; display: flex; gap: 20px; }
        .bj-btn { padding: 15px 30px; font-size: 18px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-hit { background: #2ecc71; color: #000; } .btn-stand { background: #e74c3c; color: #fff; } .btn-deal { background: #f1c40f; color: #000; width: 100%; }

        /* --- DOSTIHY SPECIFIC --- */
        .race-wrapper { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #2e2720; width: 100%;}
        .race-track { 
            width: 900px; background: #5a4b3c; border: 5px solid #8b7355; border-radius: 10px; padding: 10px; position: relative;
            background-image: repeating-linear-gradient(90deg, transparent 0, transparent 49px, rgba(255,255,255,0.1) 50px);
        }
        .finish-line { position: absolute; right: 50px; top: 0; bottom: 0; width: 5px; background: repeating-linear-gradient(0deg, #fff, #fff 10px, #000 10px, #000 20px); z-index: 0; }
        .horse-lane { height: 60px; border-bottom: 1px dashed rgba(255,255,255,0.3); position: relative; display: flex; align-items: center; }
        .horse-lane:last-child { border-bottom: none; }
        .horse-model { 
            font-size: 40px; position: absolute; left: 0; transition: left 0.1s linear; z-index: 1; filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.5));
            display: flex; align-items: center; gap: 10px;
        }
        .horse-tag { font-size: 12px; background: rgba(0,0,0,0.7); padding: 2px 5px; border-radius: 3px; color: #fff; white-space: nowrap; }
        
        .race-controls { margin-top: 20px; background: #151515; padding: 20px; border-radius: 10px; display: flex; gap: 20px; width: 900px; justify-content: space-between; align-items: center; border: 1px solid #444; }
        .horse-selector { display: flex; gap: 10px; }
        .horse-btn { background: #333; border: 1px solid #555; color: #fff; padding: 10px 15px; cursor: pointer; border-radius: 5px; display: flex; flex-direction: column; align-items: center; font-size: 12px; min-width: 80px; }
        .horse-btn.selected { background: var(--accent); color: #000; border-color: var(--accent); font-weight: bold; transform: scale(1.1); }
        .horse-btn:hover { background: #444; }
        
    </style>
</head>
<body>

    <header>
        <div class="logo">SP≈†EI <span>CASINO</span></div>
        <div class="user-panel">
            <div class="balance-box">
                <span>CZK</span>
                <span class="balance-val" id="globalBalance">5000.00</span>
            </div>
            <button class="btn-deposit" onclick="addMoney()">+ VKLAD</button>
        </div>
    </header>

    <div class="container" id="lobby">
        <div class="section-title">üî• Hern√≠ Lobby</div>
        <div class="games-grid" id="gamesGrid">
            </div>

        <br><br>
        <div class="section-title">üìä Jancoin Market</div>
        <div class="crypto-dashboard">
            <div class="crypto-info">
                <h2 style="color:var(--accent)">Jancoin (JNC)</h2>
                <p>Cena: <b id="cryptoPrice" style="font-size:1.5em">100.00</b> CZK</p>
                <p>Vlastn√≠≈°: <span id="cryptoOwned">0</span> JNC</p>
                <div style="margin-top:10px">
                    <button class="c-btn btn-buy" onclick="tradeCrypto('buy')">KOUPIT</button>
                    <button class="c-btn btn-sell" onclick="tradeCrypto('sell')">PRODAT</button>
                </div>
            </div>
            <canvas id="cryptoChart" class="crypto-chart" height="200" width="600"></canvas>
        </div>
    </div>

    <div id="slot-interface" class="game-interface">
        <div class="game-nav">
            <button class="back-btn" onclick="closeGame()">‚ùÆ Zpƒõt do Lobby</button>
            <span id="activeGameTitle" style="font-weight:bold; font-size:18px;">Hra</span>
        </div>
        <div class="slot-machine-wrapper">
            <div class="machine-body" id="machineBody">
                <h2 id="machineHeaderTitle" style="margin:0; text-transform:uppercase;">GAME</h2>
                <div class="reels">
                    <div class="reel" id="reel1">üçí</div>
                    <div class="reel" id="reel2">üçí</div>
                    <div class="reel" id="reel3">üçí</div>
                </div>
                <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-weight:bold;">
                    <span>S√°zka: <span id="slotBet">10</span></span>
                    <span>V√Ωhra: <span id="slotWin" style="color:var(--neon-green)">0</span></span>
                </div>
                <div style="margin-bottom:15px;">
                    <button class="bet-btn" onclick="adjustSlotBet(-10)">-</button>
                    <button class="bet-btn" onclick="adjustSlotBet(10)">+</button>
                    <button class="bet-btn" onclick="setSlotMaxBet()">MAX</button>
                </div>
                <button class="spin-btn" id="spinBtn" onclick="spinSlot()">ROZTOƒåIT</button>
                <p id="slotMsg" style="min-height:20px; font-weight:bold; margin-top:10px;">Hodnƒõ ≈°tƒõst√≠!</p>
            </div>
        </div>
    </div>

    <div id="roulette-interface" class="game-interface">
        <div class="game-nav">
            <button class="back-btn" onclick="closeGame()">‚ùÆ Zpƒõt do Lobby</button>
            <span style="font-weight:bold; font-size:18px;">üé° Ruleta Deluxe</span>
        </div>
        <div class="roulette-wrapper">
            <h2 style="color:#fff; margin-bottom:10px">Vyber ƒç√≠slo nebo barvu</h2>
            <div class="roulette-board" id="rouletteBoard"></div>
            <div class="roulette-controls">
                <div>
                    <p style="margin:0 0 5px 0">Tip: <span id="rSelectedInfo" style="color:var(--accent)">Nic</span></p>
                    <p style="margin:0">S√°zka: <b id="rBetAmount">100</b> CZK</p>
                </div>
                <div>
                     <button class="bet-btn" onclick="adjustRouletteBet(-100)">-</button>
                     <button class="bet-btn" onclick="adjustRouletteBet(100)">+</button>
                </div>
                <button class="spin-btn" style="width:150px; background:linear-gradient(180deg, #ff4444, #900)" onclick="spinRoulette()">TOƒåIT</button>
            </div>
            <p id="rMsg" style="height:20px; font-weight:bold; margin-top:15px; font-size:1.2em"></p>
        </div>
    </div>

    <div id="blackjack-interface" class="game-interface">
        <div class="game-nav">
            <button class="back-btn" onclick="closeGame()">‚ùÆ Zpƒõt do Lobby</button>
            <span style="font-weight:bold; font-size:18px;">‚ô†Ô∏è Blackjack Pro</span>
        </div>
        <div class="bj-wrapper">
            <div class="bj-table">
                <div class="hand-area">
                    <span style="color:#ccc; font-size:14px; margin-bottom:5px;">DEALER</span>
                    <div class="score-bubble" id="dealerScore">0</div>
                    <div class="cards-container" id="dealerCards"></div>
                </div>
                <h2 id="bjResult" style="position:absolute; top:45%; left:0; right:0; text-align:center; font-size:3em; margin:0; text-shadow:0 0 10px #000; pointer-events:none;"></h2>
                <div class="hand-area">
                    <div class="cards-container" id="playerCards"></div>
                    <div class="score-bubble" id="playerScore">0</div>
                    <span style="color:#ccc; font-size:14px; margin-top:5px;">TY</span>
                </div>
            </div>
            <div class="roulette-controls" style="margin-top:20px; width:800px; justify-content:space-between;">
                <div>
                    <span style="display:block">S√°zka: <b id="bjBetAmount">100</b> CZK</span>
                    <div style="margin-top:5px">
                        <button class="bet-btn" onclick="adjustBjBet(-100)">-</button>
                        <button class="bet-btn" onclick="adjustBjBet(100)">+</button>
                    </div>
                </div>
                <div id="bjActions" style="display:none; gap:10px;">
                    <button class="bj-btn btn-hit" onclick="bjHit()">HIT (Karta)</button>
                    <button class="bj-btn btn-stand" onclick="bjStand()">STAND (St√°t)</button>
                </div>
                <div id="bjDealDiv">
                    <button class="bj-btn btn-deal" onclick="bjDeal()">ROZDAT</button>
                </div>
            </div>
        </div>
    </div>

    <div id="race-interface" class="game-interface">
        <div class="game-nav">
            <button class="back-btn" onclick="closeGame()">‚ùÆ Zpƒõt do Lobby</button>
            <span style="font-weight:bold; font-size:18px;">üêé Dostihy SP≈†EI</span>
        </div>
        <div class="race-wrapper">
            <h2 id="raceStatus" style="color:var(--accent); margin-bottom:10px;">Vyber konƒõ a vsaƒè!</h2>
            
            <div class="race-track" id="raceTrack">
                <div class="finish-line"></div>
                </div>

            <div class="race-controls">
                <div>
                    <p style="margin:0 0 5px 0; color:#888;">FAVORIT:</p>
                    <div class="horse-selector" id="horseSelector">
                        </div>
                </div>
                
                <div style="border-left:1px solid #333; padding-left:20px;">
                    <p style="margin:0 0 5px 0">S√°zka: <b id="raceBetAmount">100</b> CZK</p>
                    <div>
                        <button class="bet-btn" onclick="adjustRaceBet(-100)">-</button>
                        <button class="bet-btn" onclick="adjustRaceBet(100)">+</button>
                    </div>
                </div>

                <button class="spin-btn" id="startRaceBtn" style="width:150px; background:linear-gradient(180deg, #e67e22, #d35400)" onclick="startRace()">START</button>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        //  ‚öôÔ∏è KONFIGURACE (TADY M≈Æ≈ΩE≈† UPRAVOVAT)
        // ==========================================
        
        // 1. AUTOMATY
        const GAMES = [
            { id: 1, name: "Inzul√≠nov√Ω Automat", winChance: 40, color: "#ff5555", symbols: ["üíâ", "ü©∏", "üç¨", "üöë", "üç∞", "üíÄ", "üíä"], icon: "üíâ" },
            { id: 2, name: "Automatomat Gargamela", winChance: 25, color: "#5555ff", symbols: ["üêà", "üßô‚Äç‚ôÇÔ∏è", "üçÑ", "üß™", "ü•ò", "üè∞", "‚ö°"], icon: "üßô‚Äç‚ôÇÔ∏è" },
            { id: 3, name: "Niƒçeho Gamba", winChance: 10, color: "#888888", symbols: ["üö¨", "üí®", "ü•É", "üï∂Ô∏è", "‚ö´", "üé≤", "üåë"], icon: "üï∂Ô∏è" },
            { id: 4, name: "Vyj√≠d√°ƒçkovo Gamba", winChance: 50, color: "#e67e22", symbols: ["üöú", "ü•ì", "üå≠", "üç∫", "üê∑", "üßÖ", "üçü"], icon: "üå≠" },
            { id: 5, name: "Zarybovo Automat", winChance: 30, color: "#3498db", symbols: ["üêü", "üê†", "üé£", "ü¶à", "ü¶û", "üåä", "‚öì"], icon: "üêü" },
            { id: 6, name: "R√°kosn√≠k-Mat", winChance: 35, color: "#2ecc71", symbols: ["üê∏", "üéã", "üåú", "‚ú®", "üö§", "ü¶ü", "ü•í"], icon: "üéã" },
            { id: 7, name: "SPSEMOH.cz", winChance: 90, color: "#9b59b6", symbols: ["üíª", "üíæ", "üîå", "üìö", "üéì", "‚òï", "ü§ñ"], icon: "üíª" },
            { id: 8, name: "Jancoin Bonanza", winChance: 33, color: "#f1c40f", symbols: ["ü™ô", "üöÄ", "üìâ", "üêÇ", "üí∞", "üíé", "üåô"], icon: "üöÄ" }
        ];

        // 2. KONƒö
        const HORSES = [
            { id: 1, name: "Damian", color: "#ff4444", icon: "üêé" },
            { id: 2, name: "Radoslav", color: "#4444ff", icon: "ü¶Ñ" },
            { id: 3, name: "Vyjidacek", color: "#00ff88", icon: "ü¶ì" },
            { id: 4, name: "Gargamel", color: "#ffd700", icon: "üê¥" },
            { id: 5, name: "Roman", color: "#ffffff", icon: "üèá" }
        ];

        // 3. OSTATN√ç KONFIG
        const ROULETTE_CONFIG = { rigged: false, riggedWinChance: 50 };
        const BLACKJACK_CONFIG = { dealerCheats: false };
        const CRYPTO_CONFIG = { volatility: 5.0, trend: 0.1 };

        // --- STAV ---
        let balance = 5000;
        let currentSlotBet = 10;
        
        let cryptoPrice = 100; let cryptoOwned = 0; let cryptoHistory = [100];
        const ctx = document.getElementById('cryptoChart').getContext('2d');

        let rouletteBet = 100; let rouletteSelection = null;
        const redNumbers = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];

        let bjBet = 100; let bjDeck = []; let bjPlayerHand = []; let bjDealerHand = []; let bjGameActive = false;

        let raceBet = 100; let selectedHorse = null; let raceActive = false; let horsePositions = [0,0,0,0,0];

        // --- INIT LOBBY ---
        const grid = document.getElementById('gamesGrid');
        
        // Automaty
        GAMES.forEach(game => {
            const card = document.createElement('div');
            card.className = 'game-card'; card.onclick = () => openSlotGame(game.id);
            card.innerHTML = `<div class="card-img" style="color: ${game.color}; text-shadow: 0 0 20px ${game.color}66">${game.icon}<div class="card-overlay"><div class="play-btn-small">HR√ÅT</div></div></div><div class="card-info"><span class="card-title">${game.name}</span><span class="card-provider">≈†ance: ${game.winChance}%</span></div>`;
            grid.appendChild(card);
        });

        // Ruleta Card
        const rCard = document.createElement('div'); rCard.className = 'game-card'; rCard.onclick = () => openRouletteGame(); rCard.style.borderColor = "#ff4444";
        rCard.innerHTML = `<div class="card-img" style="background: radial-gradient(#900, #000); color: #fff;">üé°<div class="card-overlay"><div class="play-btn-small">HR√ÅT</div></div></div><div class="card-info"><span class="card-title">RULETA DELUXE</span><span class="card-provider">Stoln√≠ hra</span></div>`;
        grid.appendChild(rCard);

        // Blackjack Card
        const bjCard = document.createElement('div'); bjCard.className = 'game-card'; bjCard.onclick = () => openBlackjackGame(); bjCard.style.borderColor = "#2ecc71";
        bjCard.innerHTML = `<div class="card-img" style="background: radial-gradient(#050, #000); color: #fff;">‚ô†Ô∏è<div class="card-overlay"><div class="play-btn-small">HR√ÅT</div></div></div><div class="card-info"><span class="card-title">BLACKJACK PRO</span><span class="card-provider">Karty</span></div>`;
        grid.appendChild(bjCard);

        // Dostihy Card
        const raceCard = document.createElement('div'); raceCard.className = 'game-card'; raceCard.onclick = () => openHorseRace(); raceCard.style.borderColor = "#e67e22";
        raceCard.innerHTML = `<div class="card-img" style="background: radial-gradient(#5a4b3c, #000); color: #fff;">üèá<div class="card-overlay"><div class="play-btn-small">HR√ÅT</div></div></div><div class="card-info"><span class="card-title">DOSTIHY SP≈†EI</span><span class="card-provider">Sportovn√≠ s√°zky</span></div>`;
        grid.appendChild(raceCard);

        // Init Ruleta Board
        const rBoard = document.getElementById('rouletteBoard');
        const zero = document.createElement('div'); zero.className = 'r-num r-green'; zero.textContent = "0"; zero.onclick = () => selectRouletteBet(0, zero); rBoard.appendChild(zero);
        for(let i=1; i<=36; i++) {
            const d = document.createElement('div'); d.textContent = i; d.className = `r-num ${redNumbers.includes(i) ? 'r-red' : 'r-black'}`; d.onclick = () => selectRouletteBet(i, d); rBoard.appendChild(d);
        }
        const btnRed = document.createElement('div'); btnRed.className = 'r-num r-red'; btnRed.style.gridColumn = "span 6"; btnRed.textContent = "üî¥ ƒåERVEN√Å"; btnRed.onclick = () => selectRouletteBet('red', btnRed);
        const btnBlack = document.createElement('div'); btnBlack.className = 'r-num r-black'; btnBlack.style.gridColumn = "span 6"; btnBlack.textContent = "‚ö´ ƒåERN√Å"; btnBlack.onclick = () => selectRouletteBet('black', btnBlack);
        rBoard.appendChild(btnRed); rBoard.appendChild(btnBlack);

        // --- COMMON UI ---
        function updateUI() { document.getElementById('globalBalance').textContent = balance.toFixed(2); document.getElementById('cryptoOwned').textContent = cryptoOwned.toFixed(4); document.getElementById('cryptoPrice').textContent = cryptoPrice.toFixed(2); }
        function addMoney() { balance += 1000; updateUI(); }
        function closeGame() { document.querySelectorAll('.game-interface').forEach(el => el.style.display = 'none'); document.getElementById('lobby').style.display = 'block'; }

        // =======================
        //  AUTOMATY
        // =======================
        function openSlotGame(id) {
            const activeGame = GAMES.find(g => g.id === id);
            document.getElementById('activeGameTitle').textContent = activeGame.name; document.getElementById('machineHeaderTitle').textContent = activeGame.name; document.getElementById('machineHeaderTitle').style.color = activeGame.color; document.getElementById('machineBody').style.borderColor = activeGame.color;
            ['reel1','reel2','reel3'].forEach(r => document.getElementById(r).textContent = activeGame.icon);
            document.getElementById('lobby').style.display = 'none'; document.getElementById('slot-interface').style.display = 'flex';
            window.activeSlotGame = activeGame;
        }
        function adjustSlotBet(val) { currentSlotBet = Math.max(10, Math.min(Math.floor(balance), currentSlotBet + val)); document.getElementById('slotBet').textContent = currentSlotBet; }
        function setSlotMaxBet() { currentSlotBet = Math.max(10, Math.floor(balance)); document.getElementById('slotBet').textContent = currentSlotBet; }
        function spinSlot() {
            if(balance < currentSlotBet) { document.getElementById('slotMsg').textContent = "Chyb√≠ kredit!"; return; }
            balance -= currentSlotBet; updateUI(); document.getElementById('spinBtn').disabled = true; document.getElementById('slotMsg').textContent = "Toƒç√≠ se...";
            ['reel1','reel2','reel3'].forEach(id => { document.getElementById(id).classList.add('spinning'); document.getElementById(id).textContent = ""; });
            const isWin = (Math.random() * 100) < window.activeSlotGame.winChance;
            let final = isWin ? Array(3).fill(window.activeSlotGame.symbols[Math.floor(Math.random() * window.activeSlotGame.symbols.length)]) : [0,1,2].map(() => window.activeSlotGame.symbols[Math.floor(Math.random() * window.activeSlotGame.symbols.length)]);
            setTimeout(() => stopSlotReel(1, final[0]), 500); setTimeout(() => stopSlotReel(2, final[1]), 1000); setTimeout(() => stopSlotReel(3, final[2], isWin), 1500);
        }
        function stopSlotReel(n, s, check) {
            const r = document.getElementById(`reel${n}`); r.classList.remove('spinning'); r.textContent = s;
            if(check !== undefined) {
                document.getElementById('spinBtn').disabled = false;
                if(check) {
                    const win = currentSlotBet * (5 + window.activeSlotGame.symbols.indexOf(s) * 5);
                    balance += win; updateUI(); document.getElementById('slotWin').textContent = win; document.getElementById('slotMsg').textContent = `V√ùHRA! ${win} CZK`; document.getElementById('slotMsg').style.color = "#00ff88";
                } else { document.getElementById('slotWin').textContent = "0"; document.getElementById('slotMsg').textContent = "Nic."; document.getElementById('slotMsg').style.color = "#fff"; }
            }
        }

        // =======================
        //  RULETA
        // =======================
        function openRouletteGame() { document.getElementById('lobby').style.display = 'none'; document.getElementById('roulette-interface').style.display = 'flex'; }
        function adjustRouletteBet(val) { rouletteBet = Math.max(10, Math.min(Math.floor(balance), rouletteBet + val)); document.getElementById('rBetAmount').textContent = rouletteBet; }
        function selectRouletteBet(s, el) { rouletteSelection = s; document.querySelectorAll('.r-num').forEach(e => e.classList.remove('r-selected')); el.classList.add('r-selected'); document.getElementById('rSelectedInfo').textContent = (s==='red'?'ƒåERVEN√Å':s==='black'?'ƒåERN√Å':s); }
        function spinRoulette() {
            if(rouletteSelection === null || balance < rouletteBet) return;
            balance -= rouletteBet; updateUI(); document.getElementById('rMsg').textContent = "Toƒç√≠ se...";
            let rolls=0; const int = setInterval(() => {
                document.querySelectorAll('.r-num').forEach(e => e.classList.remove('r-highlight'));
                const rand = rBoard.children[Math.floor(Math.random()*37)]; if(rand) rand.classList.add('r-highlight');
                if(++rolls > 20) { clearInterval(int); finalizeRoulette(); }
            }, 100);
        }
        function finalizeRoulette() {
            let res = Math.floor(Math.random() * 37);
            if(ROULETTE_CONFIG.rigged && Math.random()*100 < ROULETTE_CONFIG.riggedWinChance) res = (typeof rouletteSelection === 'number') ? rouletteSelection : (rouletteSelection==='red'?redNumbers[0]:2);
            document.querySelectorAll('.r-num').forEach(e => e.classList.remove('r-highlight')); rBoard.children[res].classList.add('r-highlight');
            let win = 0;
            if(rouletteSelection === res) win = rouletteBet * 36;
            else if(rouletteSelection === 'red' && redNumbers.includes(res)) win = rouletteBet * 2;
            else if(rouletteSelection === 'black' && !redNumbers.includes(res) && res !== 0) win = rouletteBet * 2;
            if(win > 0) { balance += win; updateUI(); document.getElementById('rMsg').textContent = `Padla ${res}. V√ùHRA ${win} CZK!`; document.getElementById('rMsg').style.color = "#00ff88"; } else { document.getElementById('rMsg').textContent = `Padla ${res}. Prohra.`; document.getElementById('rMsg').style.color = "#ff4444"; }
        }

        // =======================
        //  BLACKJACK
        // =======================
        const SUITS = ['‚ô•', '‚ô¶', '‚ô£', '‚ô†'], VALUES = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
        function openBlackjackGame() { document.getElementById('lobby').style.display = 'none'; document.getElementById('blackjack-interface').style.display = 'flex'; resetBjTable(); }
        function adjustBjBet(val) { if(bjGameActive) return; bjBet = Math.max(10, Math.min(Math.floor(balance), bjBet + val)); document.getElementById('bjBetAmount').textContent = bjBet; }
        function createDeck() { let deck=[]; for(let s of SUITS) for(let v of VALUES) deck.push({value:v, suit:s}); return deck.sort(()=>Math.random()-0.5); }
        function getCardValue(c) { if(['J','Q','K'].includes(c.value)) return 10; if(c.value==='A') return 11; return parseInt(c.value); }
        function calculateHand(h) { let sum=0, aces=0; h.forEach(c=>{sum+=getCardValue(c); if(c.value==='A') aces++}); while(sum>21 && aces>0) {sum-=10; aces--} return sum; }
        function renderCard(c, id, hidden=false) { const el = document.createElement('div'); el.className = `playing-card ${['‚ô•','‚ô¶'].includes(c.suit)?'red':''} ${hidden?'hidden':''}`; el.innerHTML = hidden?'':`<span>${c.value}</span><span style="font-size:30px">${c.suit}</span><span>${c.value}</span>`; document.getElementById(id).appendChild(el); }
        function resetBjTable() { document.getElementById('dealerCards').innerHTML = ''; document.getElementById('playerCards').innerHTML = ''; document.getElementById('dealerScore').textContent = '0'; document.getElementById('playerScore').textContent = '0'; document.getElementById('bjResult').textContent = ''; document.getElementById('bjActions').style.display = 'none'; document.getElementById('bjDealDiv').style.display = 'block'; bjGameActive = false; }
        function bjDeal() {
            if(balance < bjBet) { alert("Nem√°≈° kredit!"); return; }
            balance -= bjBet; updateUI(); bjDeck = createDeck(); bjPlayerHand = [bjDeck.pop(), bjDeck.pop()]; bjDealerHand = [bjDeck.pop(), bjDeck.pop()]; resetBjTable(); document.getElementById('bjDealDiv').style.display = 'none'; document.getElementById('bjActions').style.display = 'flex'; bjGameActive = true;
            bjPlayerHand.forEach(c => renderCard(c, 'playerCards')); document.getElementById('playerScore').textContent = calculateHand(bjPlayerHand);
            renderCard(bjDealerHand[0], 'dealerCards'); renderCard(bjDealerHand[1], 'dealerCards', true); document.getElementById('dealerScore').textContent = "?";
            if(calculateHand(bjPlayerHand) === 21) bjStand();
        }
        function bjHit() { const c = bjDeck.pop(); bjPlayerHand.push(c); renderCard(c, 'playerCards'); const s = calculateHand(bjPlayerHand); document.getElementById('playerScore').textContent = s; if(s > 21) endBjRound("BUST! Prohr√°l jsi."); }
        function bjStand() {
            document.getElementById('dealerCards').innerHTML = ''; bjDealerHand.forEach(c => renderCard(c, 'dealerCards')); let dScore = calculateHand(bjDealerHand); document.getElementById('dealerScore').textContent = dScore;
            const dealerLoop = setInterval(() => {
                if(dScore < 17) { const c = bjDeck.pop(); bjDealerHand.push(c); renderCard(c, 'dealerCards'); dScore = calculateHand(bjDealerHand); document.getElementById('dealerScore').textContent = dScore; }
                else { clearInterval(dealerLoop); determineBjWinner(dScore); }
            }, 800);
        }
        function determineBjWinner(dScore) {
            const pScore = calculateHand(bjPlayerHand); const msg = document.getElementById('bjResult');
            if(dScore > 21 || pScore > dScore) { balance += bjBet * 2; msg.textContent = "V√ùHRA!"; msg.style.color = "#00ff88"; }
            else if(pScore === dScore) { if(BLACKJACK_CONFIG.dealerCheats) { msg.textContent = "Rem√≠za (Dealer bere)."; msg.style.color = "#ff4444"; } else { balance += bjBet; msg.textContent = "PUSH (Rem√≠za)."; msg.style.color = "#ffd700"; } }
            else { msg.textContent = "PROHRA."; msg.style.color = "#ff4444"; }
            updateUI(); bjGameActive = false; document.getElementById('bjActions').style.display = 'none'; document.getElementById('bjDealDiv').style.display = 'block';
        }
        function endBjRound(text) { const m = document.getElementById('bjResult'); m.textContent = text; m.style.color = "#ff4444"; bjGameActive = false; document.getElementById('bjActions').style.display = 'none'; document.getElementById('bjDealDiv').style.display = 'block'; document.getElementById('dealerCards').innerHTML = ''; bjDealerHand.forEach(c => renderCard(c, 'dealerCards')); document.getElementById('dealerScore').textContent = calculateHand(bjDealerHand); }

        // =======================
        //  DOSTIHY (NOV√â)
        // =======================
        function openHorseRace() {
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('race-interface').style.display = 'flex';
            
            // Render Track
            const track = document.getElementById('raceTrack');
            track.innerHTML = '<div class="finish-line"></div>';
            HORSES.forEach((h, index) => {
                track.innerHTML += `
                    <div class="horse-lane">
                        <div class="horse-model" id="horse_${index}" style="color:${h.color}">
                            ${h.icon} <span class="horse-tag">${h.name}</span>
                        </div>
                    </div>`;
            });
            
            // Render Selectors
            const sel = document.getElementById('horseSelector');
            sel.innerHTML = '';
            HORSES.forEach((h, index) => {
                const btn = document.createElement('div');
                btn.className = 'horse-btn';
                btn.onclick = () => selectHorse(index, btn);
                btn.innerHTML = `<span style="font-size:20px">${h.icon}</span><span>${h.name}</span>`;
                sel.appendChild(btn);
            });
            
            selectedHorse = null;
            document.getElementById('raceStatus').textContent = "Vyber konƒõ a vsaƒè!";
            resetRacePositions();
        }

        function adjustRaceBet(val) {
            if(raceActive) return;
            raceBet = Math.max(10, Math.min(Math.floor(balance), raceBet + val));
            document.getElementById('raceBetAmount').textContent = raceBet;
        }

        function selectHorse(index, btn) {
            if(raceActive) return;
            selectedHorse = index;
            document.querySelectorAll('.horse-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            document.getElementById('raceStatus').textContent = `Vybr√°n k≈Ø≈à: ${HORSES[index].name}`;
        }

        function resetRacePositions() {
            horsePositions = [0,0,0,0,0];
            HORSES.forEach((h, i) => {
                document.getElementById(`horse_${i}`).style.left = '0%';
            });
        }

        function startRace() {
            if(selectedHorse === null) { document.getElementById('raceStatus').textContent = "Nejd≈ô√≠v vyber konƒõ!"; return; }
            if(balance < raceBet) { document.getElementById('raceStatus').textContent = "Nem√°≈° pen√≠ze!"; return; }
            
            balance -= raceBet; updateUI();
            raceActive = true;
            document.getElementById('startRaceBtn').disabled = true;
            document.getElementById('raceStatus').textContent = "START!";
            resetRacePositions();

            const raceInterval = setInterval(() => {
                let winner = -1;
                
                // Pohyb kon√≠
                for(let i=0; i<5; i++) {
                    // N√°hodn√° rychlost ka≈æd√©ho kroku
                    const speed = Math.random() * 2.5; 
                    horsePositions[i] += speed;
                    
                    const el = document.getElementById(`horse_${i}`);
                    el.style.left = Math.min(90, horsePositions[i]) + '%'; // 90% je c√≠l
                    
                    if(horsePositions[i] >= 90) {
                        winner = i;
                        break;
                    }
                }

                if(winner !== -1) {
                    clearInterval(raceInterval);
                    finalizeRace(winner);
                }
            }, 50); // Rychlost animace
        }

        function finalizeRace(winnerIndex) {
            raceActive = false;
            document.getElementById('startRaceBtn').disabled = false;
            
            const winnerName = HORSES[winnerIndex].name;
            
            if(selectedHorse === winnerIndex) {
                const win = raceBet * 5; // 5 kon√≠ = 5x v√Ωhra
                balance += win; updateUI();
                document.getElementById('raceStatus').innerHTML = `V√≠tƒõz: ${winnerName} <br> <span style="color:#00ff88">VYHR√ÅL JSI ${win} CZK!</span>`;
            } else {
                document.getElementById('raceStatus').innerHTML = `V√≠tƒõz: ${winnerName} <br> <span style="color:#ff4444">Prohra.</span>`;
            }
        }

        // =======================
        //  KRYPTO & INIT
        // =======================
        function tradeCrypto(action) {
            if (action === 'buy') { if (balance >= cryptoPrice) { balance -= cryptoPrice; cryptoOwned += 1; } else alert("Nem√°≈° dost penƒõz!"); } 
            else { if (cryptoOwned >= 1) { balance += cryptoPrice; cryptoOwned -= 1; } else alert("Nem√°≈° Jancoin!"); }
            updateUI();
        }
        setInterval(() => {
            let change = (Math.random() - 0.5) * CRYPTO_CONFIG.volatility + CRYPTO_CONFIG.trend;
            cryptoPrice = Math.max(1, cryptoPrice + change);
            cryptoHistory.push(cryptoPrice); if(cryptoHistory.length > 50) cryptoHistory.shift();
            ctx.clearRect(0, 0, 600, 200); ctx.strokeStyle = '#00ff88'; ctx.lineWidth = 2; ctx.beginPath();
            const max = Math.max(...cryptoHistory), min = Math.min(...cryptoHistory), range = max - min || 1;
            for(let i=0; i<cryptoHistory.length; i++) {
                const x = (i / (cryptoHistory.length - 1)) * 600;
                const y = 200 - ((cryptoHistory[i] - min) / range) * 180 - 10;
                if(i===0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
            }
            ctx.stroke(); updateUI();
        }, 1000);

        updateUI();
    </script>
</body>
</html>